{% extends "base.html" %}

{% block content %}

{% load static from staticfiles %}


<h1>My Schedule</h1>

<div class="row">
    <div class="col-md-8">
    <canvas id="schedule" width="700" height="300"></canvas>
    </div>
<div class="col-md-1">
</div>

<div class="col-md-3">
share
</div>
</div>

<h2>Search for courses</h2>
<div class="right-inner-addon">
  <i class="icon-search"></i>
  <input type="search" class="form-control" id="filter" placeholder="Search for classes..." />
</div>

<div id="courseList" class="row" id="accordion">
  {% for course in courses %}
  <div class="panel panel-default">
    <div class="panel-heading">
      <a data-toggle="collapse" data-parent="#accordion" href="#collapse-{{course.dept}}-{{course.number}}">{{course}}</a></div>

    <div id="collapse-{{course.dept}}-{{course.number}}" class="panel-collapse collapse ">
    <div class="panel-body">
      <table class="table table-striped">
        <thead>
          <tr>
            <th>Course id</th>
            <th>Class time</th>
            <th>Taught by</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
        {% for section in course.section_set.all %}
        <tr>
          <td>{{ section.courseid }}</td>
          <td><i>{% for session in section.session_set.all %} {{ session }}, {% endfor %}</i></td>
          <td>{{ section.professor }}</td>
          <td><a href="#">More info</a> | <a href="#"> Enroll</a></td>
        </tr>
        {% endfor %}
        </tbody>
      </table>
    </div>
    </div>
  </div>
  {% endfor %}
</div>

<script src="http://code.jquery.com/jquery-latest.js"></script>
<!-- Latest compiled and minified JavaScript -->
<script src="//netdna.bootstrapcdn.com/bootstrap/3.0.3/js/bootstrap.min.js"></script>
<script src="{% static "schedule.js" %}"></script>
<script type="text/javascript">
  $(document).ready(function(){
    // Set a start and end time to display
    // 10am -> 8pm
    var schedStartTime = [10, 0]; // [h, m]
    var schedEndTime = [20, 0];
    
    // Initialize everything
    initializeCanvas($("#schedule"), schedStartTime, schedEndTime, function(clickInfo) {
      // Edit this to choose what to do when class is clicked
      console.log(clickInfo);
      //$('#clickInfo').val(JSON.stringify(clickInfo));
    });
    
    // Add classes
    addClass([17,30],[19,10],"Tuesday","CHEM 437");
    addClass([17,30],[19,10],"Thursday","CHEM 437");
    addClass([13,00],[14,10],"Monday","MATH 221");
    addClass([13,00],[14,10],"Wednesday","MATH 221");

    addClass([16,00],[17,15],"Monday","CMSC 203");
    addClass([16,00],[17,15],"Wednesday","CMSC 203");
    
    // Get the image string:
    //pngURI = screenshot();

    ///////////////////////////////
    // Live search
    // Credit: http://stackoverflow.com/questions/15103358/live-search-in-jquery
    $("#filter").keyup(function(){
      // Retrieve the input field text and reset the count to zero
      var filter = $(this).val(), count = 0;

      // Loop through the comment list
      $("#courseList > div").each(function(){

        // If the list item does not contain the text phrase fade it out
        if ($(this).text().search(new RegExp(filter, "i")) < 0) {
          $(this).fadeOut();

        // Show the list item if the phrase matches and increase the count by 1
        } else {
          $(this).show();
          count++;
        }
      });

      // Update the count
      //var numberItems = count;
      //$("#filter-count").text("Number of Comments = "+count);
    });
    // Prevent Enter key from submitting the form
    $("#filter").keypress(function(e){
      if(event.keyCode == 13) {
        e.preventDefault();
        return false;
      }
    });
    ////////////////////////
  });
  
  
</script>


{% endblock %}
